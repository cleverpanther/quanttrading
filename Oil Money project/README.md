# Oil Money

<b><font color="#6F6F6F" size="+5"> Norwegian Krone and Brent Crude </font></b><br>

This is a project inspired by an article that I read. During low volatility period, the article recommended to trade petrocurrency such as Norwegian Krone when the oil price was bouncing back. To my curiosity, I intended to find out if this idea is plausible. First thing came to my mind was whether the correlation between Norwegian Krone and Brent Crude was substantial. Norway is one of my fav places in Europe. Unlike Qatar or Saudi Arabia or any other gulf countries, it doesn't heavily rely on oil for its gross income. 

![alt text](https://github.com/tattooday/quant-trading/blob/master/Oil%20Money%20project/preview/global%20oil%20production.png)

I doubted if oil price is the only factor that affects the exchange rate of NOK. I looked into international trading statistics of Norway. Basically, most trading partners are inside European Union. Prior to stats, I included UK sterling and Euro in the regression model. To my surprise, Norway is actually doing a lot of business with US. Thus, the model regressor consisted of EUR, GBP, USD and Brent Crude. After model identification, I had to choose a currency to evaluate NOK. It should be a stable entity with not much connection to Norway's economy. I picked the safe haven currency in East Asia, JPY! Hence, all currencies involved in the model would be evaluated by Japanese Yen. Our regressor variables are EURJPY, GBPJPY, USDJPY and Brent Crude in JPY. Our regressand variable is NOKJPY.

In this demonstration, we denoted time before 2017-04-25 as training horizon. We would use that period to fit a good model. From 2017-04-25 to the end of our dataset, that would be denoted as testing period. We would use our model to forecast and do backtesting in testing horizon. The regression result came out as below. We had a pretty high R square. All T stats and F stats were significant. As the summary suggested, there could be multicollinearity (condition number was large). I wouldn't doubt it as Brent Crude and USD should be negatively correlated. Most commodity future contracts are priced in US dollar. When US dollar appreciates or depreciates, the underlying commodity price is going the opposite way. There may be a cointegration relationship between UK sterling and Euro as well.

![alt text](https://github.com/tattooday/quant-trading/blob/master/Oil%20Money%20project/preview/model%20summary.png)

In this case, we could use elastic net regression to implement a penalty function on this multicollinearity problem. Elastic net is a statistics/machine learning technique that consists of Lasso and Ridge regression (https://en.wikipedia.org/wiki/Elastic_net_regularization ). Assuming elastic net correctly estimated the parameters, let us take elastic net fitted result to subtract from OLS fitted result. From the figure below, we could tell the distribution of the difference is negatively skewed which implies OLS overestimated NOK.

![alt text](https://github.com/tattooday/quant-trading/blob/master/Oil%20Money%20project/preview/ols%20vs%20elastic%20net.png)

The next step, we took the residuals from both estimations and checked their standard deviations. It turned out that elastic net regression delivered a smaller standard deviation. Now we could determine OLS estimation was biased and elastic net estimation would be the better approach for modelling. Before backtesting, we ought to set up thresholds for signal generation. For common practise in statistical arbitrage, we take one sigma away from our fitted value as thresholds. When actual NOK price goes above the upper threshold, we take a short position cuz we hold the belief that it would come back to its so-called normal status. For lower threshold scenario, it is vice versa. However, the model is based on historical data. No models can precisely predict the future. Our estimation is most likely to be overfitting and fail in the near future. We need to set up other thresholds for stop orders. When the model breaks, we would clear our positions and exit the trades gracefully. Let's use the golden rule in statistics, 2 sigmas with 95% confidence interval, to do the trick. If NOK deviates 2 sigmas away from our fitted value, we will end the trades with elegance. What we didn't expect from the result is that there is a strong trend (could be up/down) after our model breaks. The trend is independent of our training horizon. In another word, no matter which period we use as training horizon, a strong trend always follow for either direction. Whenever a strong trend occurs, there shall be opportunities for momentum trading! The figures below are positions prior to our signal generations and the price movement against our fitted value.

![alt text](https://github.com/tattooday/quant-trading/blob/master/Oil%20Money%20project/preview/oil%20money%20positions.png)
![alt text](https://github.com/tattooday/quant-trading/blob/master/Oil%20Money%20project/preview/fitted%20vs%20actual.png)

What really interests us is why our model doesn't work any more after 2017/11/15. Well, there is no way that a universal model can exist and work forever. Most models have short memory due to the dynamic macroeconomics and geo-politics. Based on adpative market hypothesis developed by Professor Andrew Lo (https://en.wikipedia.org/wiki/Adaptive_market_hypothesis), the players in the market are always adpating to the agile environment. So, we kinda expected our model would lose its power sooner or later. Still, we need to know what caused the model to break. A detailed causal analysis is basically writing a paper (I hate writing thesis!). I would not get into too much of that rigorous and boring empirical analysis. Instead, I intend to bring up a short but insightful discussion here.  What could possibly be the reason of this dramatic change? Could it be that Saudi and Iran endorsed an extension of oil production caps on that particular date? Or Donald Trump got elected as POTUS so he would encourage a depreciated US dollar and lift up restrictions on domestic oil business? If we think of NOK as a stochastic process, we decompose NOK into long term trend and short term random disturbance. Well, apparently short term is dominated by Brent Crude. It partially justifies our model. What really drives long term trend though? 

![alt text](https://github.com/tattooday/quant-trading/blob/master/Oil%20Money%20project/preview/brent%20crude.png)

Ta-da, its Euro. As Norway is in EEA, its economic tie with EU totally dominates the long term trend of NOK. From the normalized figure, we clearly see the trend of both NOK and EUR are somewhat correlated. To get a formal conclusion, we need a cointegration test to test all currencies. Nevertheless, there is no Johansen Test in statsmodel package (Not on the date when first draft was finished, but there is now). We would have to use Engle-Granger two step test (https://en.wikipedia.org/wiki/Cointegration#Engleâ€“Granger_two-step_method), which is invented by the mentor of my mentor! A Nobel Prize Winner! Unfortunately, we can't get any confirmation of cointegration from the test. The regression model itself is not robust. Sometimes we have to use the old fashion way to make a qualitative judgement, which is called instinct. Most big organization researchers recalibrate their forecast with policy or experience or consensus views (as an insider, I guarantee you this is 100% true). This is the time that my guts are telling me EUR is the driver of NOK's long term trend PERIOD (LOL)

![alt text](https://github.com/tattooday/quant-trading/blob/master/Oil%20Money%20project/preview/trend.png)

![alt text](https://github.com/tattooday/quant-trading/blob/master/Oil%20Money%20project/preview/EG%20failed.png)

Well, we are not economists (even though my work has a lot to do with them). Let's call it the end of our tiny analysis. In fact, we can simplify our model to NOK driven by Brent and EUR for the sake of simplicity. From an econometrician perspective, it does not sound like a good idea. Every coefficient of the model is statistically significant. Adding more variables do not worsen AIC, BIC and adjusted R squared. There is no incentive for us to remove variables as more information in the model is always better. Cool, move on. Next, let us take a look at the portfolio performance. So far so good, we actually made a few bucks from NOK based on statistical arbitrage. Interestingly, after we placed the stop order, I decided to add extra position to see what would happen to follow the trend. In the figure below, we could see the downwards momentum didn't stop until two months after the date when our model breaked (maybe another major event in financial market occured). 

![alt text](https://github.com/tattooday/quant-trading/blob/master/Oil%20Money%20project/preview/asset%20value.png)

Wow, did we just discover a momentum trading strategy! We started to seek for a statistical arbitrage opportunity between crude price and petrocurrency. What we got in the end is an entry signal of momentum trading strategy. Also, we found out Euro is the major and long term influence on Norwegian Krone, Brent Crude is the short term disturbance. My explanation for our results would be when the model breaks, there must be some fundamental situations that have changed investors' outlook in NOK forever. I tested this trading strategy on NOK for different testing horizons. It turned out that our momentum trading is much more robust and profitable than our statistical arbitrage. But does it work on any other petrocurrencies? Unfortunately, Norway is one of the largest oil producing countries with floating FX regime. The rest is US, Canada and Russia. US dollar is a totally different case. It doesn't rely on WTI price at all. Oil business only takes up a very small share in US economy. What about Russian Ruble? Well, I have attached raw data of Russian Ruble. From my tests, I could only complain about that Russia has been sanctioned by US for so many times. Modeling on Russian Ruble never seems to be robust. The situation of RUB is too volatile and dynamic (feeling sorry for Russians). If you have a better idea for research on Russian Ruble, please do not hesitate to inform me.
